<!doctype html><html lang=zh-hans><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.0.0-beta.3 for Hugo"><script src="https://www.googleoptimize.com/optimize.js?id=OPT-T64TWGJ"></script><meta name=author content="忐忑"><meta name=description content="最近试着安装做新版的mysql,过程中出现一些坎坷,所以记录下来"><meta name=keywords content="mysql,mysql8,源码安装mysql8,centos"><link rel=alternate hreflang=zh-hans href=https://twbworld.github.io/post/install_mysql8_note/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#1565c0"><link rel=stylesheet href=https://cdn.staticfile.org/font-awesome/5.14.0/css/all.min.css integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous media=print onload="this.media='all'"><link rel=stylesheet href=https://cdn.staticfile.org/highlight.js/10.2.0/styles/dracula.min.css crossorigin=anonymous title=hl-light media=print onload="this.media='all'"><link rel=stylesheet href=https://cdn.staticfile.org/highlight.js/10.2.0/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload="this.media='all'" disabled><link rel=stylesheet href=https://cdn.staticfile.org/leaflet/1.7.1/leaflet.min.css integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin=anonymous media=print onload="this.media='all'"><script src=https://cdn.staticfile.org/lazysizes/5.2.2/lazysizes.min.js integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin=anonymous async></script><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload="this.media='all'"><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/twbworld/twbworld.GitHub.io@gh-pages/css/wowchemy.dd4198da94b96ba1828f84ef95a066d2.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-165300316-1"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(a,b){gtag('event','click',{event_category:'outbound',event_label:a,transport_type:'beacon',event_callback:function(){b!=='_blank'&&(document.location=a)}}),console.debug("Outbound link clicked: "+a)}function onClickCallback(a){if(a.target.tagName!=='A'||a.target.host===window.location.host)return;trackOutboundLink(a.target,a.target.getAttribute('target'))}gtag('js',new Date),gtag('config','UA-165300316-1',{}),gtag('set',{cookie_flags:'SameSite=None;Secure'}),document.addEventListener('click',onClickCallback,!1)</script><script>(function(b,d,e,a,g){b[a]=b[a]||[],b[a].push({'gtm.start':(new Date).getTime(),event:'gtm.js'});var f=d.getElementsByTagName(e)[0],c=d.createElement(e),h=a!='dataLayer'?'&l='+a:'';c.async=!0,c.src='https://www.googletagmanager.com/gtm.js?id='+g+h,f.parentNode.insertBefore(c,f)})(window,document,'script','dataLayer','GTM-P8WL7G3')</script><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_huf8f9e04b16a1b18d734a3b791d2e4cd6_136989_32x32_fill_lanczos_center_2.png><link rel=apple-touch-icon type=image/png href=/images/icon_huf8f9e04b16a1b18d734a3b791d2e4cd6_136989_180x180_fill_lanczos_center_2.png><link rel=canonical href=https://twbworld.github.io/post/install_mysql8_note/><link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/gh/twbworld/twbworld.GitHub.io@gh-pages/css/my.css><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@twbworld"><meta property="twitter:creator" content="@twbworld"><meta property="og:site_name" content="忐忑の博客"><meta property="og:url" content="https://twbworld.github.io/post/install_mysql8_note/"><meta property="og:title" content="Centos源码安装Mysql8笔记 | 忐忑の博客"><meta property="og:description" content="最近试着安装做新版的mysql,过程中出现一些坎坷,所以记录下来"><meta property="og:image" content="https://twbworld.github.io/media/avatar.jpg"><meta property="twitter:image" content="https://twbworld.github.io/media/avatar.jpg"><meta property="og:locale" content="zh-Hans"><meta property="article:published_time" content="2020-05-30T20:47:16+08:00"><meta property="article:modified_time" content="2021-03-14T04:10:23+08:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://twbworld.github.io/post/install_mysql8_note/"},"headline":"Centos源码安装Mysql8笔记","datePublished":"2020-05-30T20:47:16+08:00","dateModified":"2021-03-14T04:10:23+08:00","author":{"@type":"Person","name":"忐忑"},"publisher":{"@type":"Organization","name":"忐忑の博客","logo":{"@type":"ImageObject","url":"https://twbworld.github.io/images/icon_huf8f9e04b16a1b18d734a3b791d2e4cd6_136989_192x192_fill_lanczos_center_2.png"}},"description":"最近试着安装做新版的mysql,过程中出现一些坎坷,所以记录下来"}</script><title>Centos源码安装Mysql8笔记 | 忐忑の博客</title><script src=https://cdn.jsdelivr.net/gh/twbworld/twbworld.GitHub.io@gh-pages/js/vendor/live2d-widget/autoload.js></script></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class="page-wrapper
bg-image parallax
waifu-left" style=background-attachment:fixed><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P8WL7G3" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript><script src=https://cdn.jsdelivr.net/gh/twbworld/twbworld.GitHub.io@gh-pages/js/wowchemy-init.min.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>搜索</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=搜索... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=搜索...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex" style=width:35%><a class=navbar-brand href=/>忐忑の博客</a></div><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>忐忑の博客</a></div><div class="navbar-collapse main-menu-item collapse justify-content-center" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#hero><span></span></a></li><li class=nav-item><a class="nav-link active" href=/post/><span></span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2" style=display:block!important;text-align:right;width:35%;height:100%><li class=nav-item style=display:inline-block><a class="nav-link js-search" title=Search href=# aria-label=搜索><i class="fas fa-search big-icon" aria-hidden=true></i></a></li><li class=nav-item style=display:inline-block><a class=nav-link title="@twbworld on github" href=https://github.com/twbworld target=_blank rel=noopener><i class="fab fa-github big-icon" aria-hidden=true></i></a></li></ul></div></nav></div><div class=page-body><article class=article><div class="article-container pt-3 post-article-header-head"><h1>Centos源码安装Mysql8笔记</h1><div class=article-metadata><span class=article-date>最近更新于
2021-03-14</span>
<span class=middot-divider></span><span class=article-reading-time>16 分钟阅读时长</span></div></div><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar post-scroll"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>目录</a></li></ul><nav id=TableOfContents><ul><li><a href=#笔记一-安装时发生警告>笔记一: 安装时,发生警告</a></li><li><a href=#笔记二-创建mycnf>笔记二: 创建my.cnf</a></li><li><a href=#笔记三-开关mysql>笔记三: 开关mysql</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-10 py-md-3 pl-md-3 docs-content" role=main><div class="article-container post-article-container"><div class=article-style><h2 id=笔记一-安装时发生警告>笔记一: 安装时,发生警告</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>
--character-set-server: <span style=color:#e6db74>&#39;utf8&#39;</span> is currently an alias <span style=color:#66d9ef>for</span> the character set UTF8MB3, but will be an alias <span style=color:#66d9ef>for</span> UTF8MB4 in a future release. Please consider using UTF8MB4 in order to be unambiguous
--collation-server: <span style=color:#e6db74>&#39;utf8_general_ci&#39;</span> is a collation of the deprecated character set UTF8MB3. Please consider using UTF8MB4 with an appropriate collation instead

</code></pre></div><p>原因 :</p><blockquote><p>安装mysql8的时候,配置了官方不推荐的"utf8",其实"utf8"就是mysql中"UTF8MB3"的别名,然而又同时存在着"UTF8MB4",所有,建议改为"UTF8MB4";</p></blockquote><p>解决 :</p><blockquote><p>把cmake的参数 <code>-DDEFAULT_CHARSET=utf8</code> 改为 <code>-DDEFAULT_CHARSET=utf8mb4</code> , <code>-DDEFAULT_COLLATION=utf8_general_ci</code> 改为 <code>-DDEFAULT_COLLATION=utf8mb4_unicode_ci</code></p></blockquote><p>给出完整cmake命令 :</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>
<span style=color:#75715e># 切换到mysql8解压后的目录</span>
cd /usr/local/mysql8/

<span style=color:#75715e># 新建并切换build目录</span>
mkdir build
cd build

<span style=color:#75715e># 编译前的配置;其中的&#34;DCMAKE_INSTALL_PREFIX&#34;, &#34;DMYSQL_DATADIR&#34;, &#34;DWITH_BOOST&#34; 按照自己的情况配置</span>
cmake .. -DCMAKE_INSTALL_PREFIX<span style=color:#f92672>=</span>/usr/local/mysql8 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DMYSQL_DATADIR<span style=color:#f92672>=</span>/usr/local/mysql8/data <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DSYSCONFDIR<span style=color:#f92672>=</span>/etc <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DWITH_MYISAM_STORAGE_ENGINE<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DWITH_INNOBASE_STORAGE_ENGINE<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DWITH_MEMORY_STORAGE_ENGINE<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DWTH_READLINE<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DMYSQL_TCP_PORT<span style=color:#f92672>=</span><span style=color:#ae81ff>3306</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DENABLED_LOCAL_INFILE<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DWITH_PARTITION_STORAGE_ENGINE<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DEXTRA_CHARSETS<span style=color:#f92672>=</span>all -DDEFAULT_CHARSET<span style=color:#f92672>=</span>utf8mb4 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DDEFAULT_COLLATION<span style=color:#f92672>=</span>utf8mb4_unicode_ci <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-DWITH_BOOST<span style=color:#f92672>=</span>/usr/local/boost_1_70_0

</code></pre></div><blockquote><p>安装后,可以看到 <code>/etc/my.cnf</code> 设置为 <code>collation-server = utf8mb4_unicode_ci</code> <code>character-set-server = utf8mb4</code></p></blockquote><hr><h2 id=笔记二-创建mycnf>笔记二: 创建my.cnf</h2><p>在/etc目录下没有发现my.cnf(我的mysql版本是mysql-8.0.20), 只能自己创建了 :</p><p><code>vim /etc/my.cnf</code></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>
<span style=color:#75715e># 客户端设置</span>
<span style=color:#f92672>[</span>client<span style=color:#f92672>]</span>
port <span style=color:#f92672>=</span> <span style=color:#ae81ff>3306</span>
<span style=color:#75715e># 默认情况下，socket文件应为/usr/local/mysql/mysql.socket,所以可以ln -s xx  /tmp/mysql.sock</span>
socket <span style=color:#f92672>=</span> /tmp/mysql.sock 

<span style=color:#75715e># 服务端设置</span>
<span style=color:#f92672>[</span>mysqld<span style=color:#f92672>]</span>

<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 基础信息</span>
<span style=color:#75715e>#Mysql服务的唯一编号 每个mysql服务Id需唯一</span>
server-id <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e>#服务端口号 默认3306</span>
port <span style=color:#f92672>=</span> <span style=color:#ae81ff>3306</span>

<span style=color:#75715e># 启动mysql服务进程的用户</span>
user <span style=color:#f92672>=</span> mysql

<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 安装目录相关</span>
<span style=color:#75715e># mysql安装根目录</span>
basedir <span style=color:#f92672>=</span> /usr/local/mysql8

<span style=color:#75715e># mysql数据文件所在位置</span>
datadir <span style=color:#f92672>=</span> /usr/local/mysql8/data

<span style=color:#75715e># 临时目录 比如load data infile会用到,一般都是使用/tmp</span>
tmpdir  <span style=color:#f92672>=</span> /tmp

<span style=color:#75715e># 设置socke文件地址</span>
socket  <span style=color:#f92672>=</span> /tmp/mysql.sock


<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 事务隔离级别，默认为可重复读（REPEATABLE-READ）。（此级别下可能参数很多间隙锁，影响性能，但是修改又影响主从复制及灾难恢复，建议还是修改代码逻辑吧）</span>
<span style=color:#75715e># 隔离级别可选项目：READ-UNCOMMITTED  READ-COMMITTED  REPEATABLE-READ  SERIALIZABLE</span>
<span style=color:#75715e># transaction_isolation = READ-COMMITTED</span>
transaction_isolation <span style=color:#f92672>=</span> REPEATABLE-READ

<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 数据库引擎与字符集相关设置</span>

<span style=color:#75715e># mysql 5.1 之后，默认引擎就是InnoDB了</span>
default_storage_engine <span style=color:#f92672>=</span> InnoDB
<span style=color:#75715e># 内存临时表默认引擎，默认InnoDB</span>
default_tmp_storage_engine <span style=color:#f92672>=</span> InnoDB

<span style=color:#75715e>#数据库默认字符集,主流字符集支持一些特殊表情符号（特殊表情符占用4个字节）</span>
character-set-server <span style=color:#f92672>=</span> utf8mb4

<span style=color:#75715e>#数据库字符集对应一些排序等规则，注意要和character-set-server对应</span>
collation-server <span style=color:#f92672>=</span> utf8mb4_unicode_ci

<span style=color:#75715e># 设置client连接mysql时的字符集,防止乱码</span>
<span style=color:#75715e># init_connect=&#39;SET NAMES utf8&#39;</span>


<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 数据库连接相关设置</span>
<span style=color:#75715e># 最大连接数，可设最大值16384，一般考虑根据同时在线人数设置一个比较综合的数字，鉴于该数值增大并不太消耗系统资源，建议直接设10000</span>
<span style=color:#75715e># 如果在访问时经常出现Too Many Connections的错误提示，则需要增大该参数值</span>
max_connections <span style=color:#f92672>=</span> <span style=color:#ae81ff>10000</span>

<span style=color:#75715e># 默认值100，最大错误连接数，如果有超出该参数值个数的中断错误连接，则该主机将被禁止连接。如需对该主机进行解禁，执行：FLUSH HOST</span>
<span style=color:#75715e># 考虑高并发场景下的容错，建议加大。</span>
max_connect_errors <span style=color:#f92672>=</span> <span style=color:#ae81ff>10000</span>

<span style=color:#75715e># MySQL打开的文件描述符限制，默认最小1024;</span>
<span style=color:#75715e># 当open_files_limit没有被配置的时候，比较max_connections*5和ulimit -n的值，哪个大用哪个，</span>
<span style=color:#75715e># 当open_file_limit被配置的时候，比较open_files_limit和max_connections*5的值，哪个大用哪个。</span>
open_files_limit <span style=color:#f92672>=</span> <span style=color:#ae81ff>65535</span>

<span style=color:#75715e># 注意：仍然可能出现报错信息Can&#39;t create a new thread；此时观察系统cat /proc/mysql进程号/limits，观察进程ulimit限制情况</span>
<span style=color:#75715e># 过小的话，考虑修改系统配置表，/etc/security/limits.conf和/etc/security/limits.d/90-nproc.conf</span>

<span style=color:#75715e># MySQL默认的wait_timeout  值为8个小时, interactive_timeout参数需要同时配置才能生效</span>
<span style=color:#75715e># MySQL连接闲置超过一定时间后(单位：秒，此处为1800秒)将会被强行关闭</span>
interactive_timeout <span style=color:#f92672>=</span> <span style=color:#ae81ff>1800</span> 
wait_timeout <span style=color:#f92672>=</span> <span style=color:#ae81ff>1800</span> 

<span style=color:#75715e># 在MySQL暂时停止响应新请求之前的短时间内多少个请求可以被存在堆栈中 </span>
<span style=color:#75715e># 官方建议back_log = 50 + (max_connections / 5),封顶数为900</span>
back_log <span style=color:#f92672>=</span> <span style=color:#ae81ff>900</span>

<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 数据库数据交换设置</span>
<span style=color:#75715e># 该参数限制服务器端，接受的数据包大小，如果有BLOB子段，建议增大此值，避免写入或者更新出错。有BLOB子段，建议改为1024M</span>
max_allowed_packet <span style=color:#f92672>=</span> 128M

<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 内存，cache与buffer设置</span>


<span style=color:#75715e># 内存临时表的最大值,默认16M，此处设置成128M</span>
tmp_table_size <span style=color:#f92672>=</span> 64M
<span style=color:#75715e># 用户创建的内存表的大小，默认16M，往往和tmp_table_size一起设置，限制用户临师表大小。</span>
<span style=color:#75715e># 超限的话，MySQL就会自动地把它转化为基于磁盘的MyISAM表，存储在指定的tmpdir目录下，增大IO压力，建议内存大，增大该数值。</span>
max_heap_table_size <span style=color:#f92672>=</span> 64M



<span style=color:#75715e># 表示这个mysql版本是否支持查询缓存。ps：SHOW STATUS LIKE &#39;qcache%&#39;，与缓存相关的状态变量。</span>
<span style=color:#75715e># have_query_cache</span>



<span style=color:#75715e># 在一个事务中binlog为了记录SQL状态所持有的cache大小</span>
<span style=color:#75715e># 如果你经常使用大的,多声明的事务,你可以增加此值来获取更大的性能.</span>
<span style=color:#75715e># 所有从事务来的状态都将被缓冲在binlog缓冲中然后在提交后一次性写入到binlog中</span>
<span style=color:#75715e># 如果事务比此值大, 会使用磁盘上的临时文件来替代.</span>
<span style=color:#75715e># 此缓冲在每个连接的事务第一次更新状态时被创建</span>
binlog_cache_size <span style=color:#f92672>=</span> 1M



<span style=color:#75715e>#*** MyISAM 相关选项</span>
<span style=color:#75715e># 指定索引缓冲区的大小, 为MYISAM数据表开启供线程共享的索引缓存,对INNODB引擎无效。相当影响MyISAM的性能。</span>
<span style=color:#75715e># 不要将其设置大于你可用内存的30%,因为一部分内存同样被OS用来缓冲行数据</span>
<span style=color:#75715e># 甚至在你并不使用MyISAM 表的情况下, 你也需要仍旧设置起 8-64M 内存由于它同样会被内部临时磁盘表使用.</span>
<span style=color:#75715e># 默认值 8M，建议值：对于内存在4GB左右的服务器该参数可设置为256M或384M。注意：该参数值设置的过大反而会是服务器整体效率降低！</span>
key_buffer_size <span style=color:#f92672>=</span> 64M

<span style=color:#75715e># 为每个扫描MyISAM的线程分配参数设置的内存大小缓冲区。 </span>
<span style=color:#75715e># 默认值128kb，建议值：16G内存建议1M，4G：128kb或者256kb吧</span>
<span style=color:#75715e># 注意，该缓冲区是每个连接独占的，所以总缓冲区大小为 128kb*连接数；极端情况128kb*maxconnectiosns，会超级大，所以要考虑日常平均连接数。</span>
<span style=color:#75715e># 一般不需要太关心该数值，稍微增大就可以了，</span>
read_buffer_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>262144</span> 

<span style=color:#75715e># 支持任何存储引擎</span>
<span style=color:#75715e># MySQL的随机读缓冲区大小，适当增大，可以提高性能。</span>
<span style=color:#75715e># 默认值256kb；建议值：得参考连接数，16G内存，有人推荐8M</span>
<span style=color:#75715e># 注意，该缓冲区是每个连接独占的，所以总缓冲区大小为128kb*连接数；极端情况128kb*maxconnectiosns，会超级大，所以要考虑日常平均连接数。</span>
read_rnd_buffer_size <span style=color:#f92672>=</span> 1M

<span style=color:#75715e># order by或group by时用到 </span>
<span style=color:#75715e># 支持所有引擎，innodb和myisam有自己的innodb_sort_buffer_size和myisam_sort_buffer_size设置</span>
<span style=color:#75715e># 默认值256kb；建议值：得参考连接数，16G内存，有人推荐8M.</span>
<span style=color:#75715e># 注意，该缓冲区是每个连接独占的，所以总缓冲区大小为 1M*连接数；极端情况1M*maxconnectiosns，会超级大。所以要考虑日常平均连接数。</span>
sort_buffer_size <span style=color:#f92672>=</span> 1M

<span style=color:#75715e># 此缓冲被使用来优化全联合(full JOINs 不带索引的联合)</span>
<span style=color:#75715e># 类似的联合在极大多数情况下有非常糟糕的性能表现,但是将此值设大能够减轻性能影响.</span>
<span style=color:#75715e># 通过 “Select_full_join” 状态变量查看全联合的数量</span>
<span style=color:#75715e># 注意，该缓冲区是每个连接独占的，所以总缓冲区大小为 1M*连接数；极端情况1M*maxconnectiosns，会超级大。所以要考虑日常平均连接数。</span>
<span style=color:#75715e># 默认值256kb;建议值：16G内存，设置8M.</span>
join_buffer_size <span style=color:#f92672>=</span> 1M

<span style=color:#75715e># 缓存linux文件描述符信息，加快数据文件打开速度</span>
<span style=color:#75715e># 它影响myisam表的打开关闭，但是不影响innodb表的打开关闭。</span>
<span style=color:#75715e># 默认值2000，建议值：根据状态变量Opened_tables去设定</span>
table_open_cache <span style=color:#f92672>=</span> <span style=color:#ae81ff>2000</span>

<span style=color:#75715e># 缓存表定义的相关信息，加快读取表信息速度</span>
<span style=color:#75715e># 默认值1400，最大值2000，建议值：基本不改。</span>
table_definition_cache <span style=color:#f92672>=</span> <span style=color:#ae81ff>1400</span>
<span style=color:#75715e># 该参数是myssql 5.6后引入的，目的是提高并发。</span>
<span style=color:#75715e># 默认值1，建议值：cpu核数，并且&lt;=16</span>
table_open_cache_instances <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>

<span style=color:#75715e># 当客户端断开之后，服务器处理此客户的线程将会缓存起来以响应下一个客户而不是销毁。可重用，减小了系统开销。</span>
<span style=color:#75715e># 默认值为9，建议值：两种取值方式，方式一，根据物理内存，1G  —&gt; 8；2G  —&gt; 16； 3G  —&gt; 32； &gt;3G  —&gt; 64；</span>
<span style=color:#75715e># 方式二，根据show status like  &#39;threads%&#39;，查看Threads_connected值。</span>
thread_cache_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>16</span>

<span style=color:#75715e># 默认值256k,建议值：16/32G内存，512kb，其他一般不改变，如果报错：Thread stack overrun，就增大看看,</span>
<span style=color:#75715e># 注意，每个线程分配内存空间，所以总内存空间。。。你懂得。</span>
thread_stack <span style=color:#f92672>=</span> 512k


<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 日志文件相关设置，一般只开启三种日志，错误日志，慢查询日志，二进制日志。普通查询日志不开启。</span>

<span style=color:#75715e># 普通查询日志，默认值off，不开启</span>
general_log <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
<span style=color:#75715e># 普通查询日志存放地址</span>
general_log_file <span style=color:#f92672>=</span> /usr/local/mysql8/log/mysql-general.log

<span style=color:#75715e># 全局动态变量，默认3，范围：1～3</span>
<span style=color:#75715e># 表示错误日志记录的信息，1：只记录error信息；2：记录error和warnings信息；3：记录error、warnings和普通的notes信息。</span>
log_error_verbosity <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>
<span style=color:#75715e># 错误日志文件地址</span>
log_error <span style=color:#f92672>=</span> /usr/local/mysql8/log/mysql-error.log


<span style=color:#75715e># 开启慢查询</span>
slow_query_log <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e># 开启慢查询时间，此处为1秒，达到此值才记录数据</span>
long_query_time <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>

<span style=color:#75715e># 检索行数达到此数值，才记录慢查询日志中</span>
min_examined_row_limit <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>

<span style=color:#75715e># mysql 5.6.5新增，用来表示每分钟允许记录到slow log的且未使用索引的SQL语句次数，默认值为0，不限制。</span>
log_throttle_queries_not_using_indexes <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>

<span style=color:#75715e># 慢查询日志文件地址</span>
slow_query_log_file <span style=color:#f92672>=</span> /usr/local/mysql8/log/mysql-slow.log

<span style=color:#75715e># 开启记录没有使用索引查询语句</span>
log-queries-not-using-indexes <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>


<span style=color:#75715e># 开启二进制日志</span>
log_bin <span style=color:#f92672>=</span> /usr/local/mysql8/log/mysql-bin.log
<span style=color:#75715e># mysql清除过期日志的时间，默认值30*24*60*60，</span>
binlog_expire_logs_seconds<span style=color:#f92672>=</span><span style=color:#ae81ff>604800</span>
<span style=color:#75715e># 如果二进制日志写入的内容超出给定值，日志就会发生滚动。你不能将该变量设置为大于1GB或小于4096字节。 默认值是1GB。</span>
max_binlog_size <span style=color:#f92672>=</span> 1000M
<span style=color:#75715e># binlog的格式也有三种：STATEMENT，ROW，MIXED。mysql 5.7.7后，默认值从 MIXED 改为 ROW</span>
<span style=color:#75715e># 关于binlog日志格式问题，请查阅网络资料</span>
binlog_format <span style=color:#f92672>=</span> row
<span style=color:#75715e># 默认值N=1，使binlog在每N次binlog写入后与硬盘同步，ps：1最慢</span>
<span style=color:#75715e># sync_binlog = 1 </span>

<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># innodb选项</span>

<span style=color:#75715e># 说明：该参数可以提升扩展性和刷脏页性能。</span>
<span style=color:#75715e># 默认值1，建议值：4-8；并且必须小于innodb_buffer_pool_instances</span>
innodb_page_cleaners <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>

<span style=color:#75715e># 说明：一般8k和16k中选择，8k的话，cpu消耗小些，selcet效率高一点，一般不用改</span>
<span style=color:#75715e># 默认值：16k；建议值：不改，</span>
innodb_page_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>16384</span>

<span style=color:#75715e># 说明：InnoDB使用一个缓冲池来保存索引和原始数据, 不像MyISAM.这里你设置越大,你在存取表里面数据时所需要的磁盘I/O越少.</span>
<span style=color:#75715e># 在一个独立使用的数据库服务器上,你可以设置这个变量到服务器物理内存大小的60%-80%</span>
<span style=color:#75715e># 注意别设置的过大，会导致system的swap空间被占用，导致操作系统变慢，从而减低sql查询的效率</span>
<span style=color:#75715e># 默认值：128M，建议值：物理内存的60%-80%</span>
innodb_buffer_pool_size <span style=color:#f92672>=</span> 512M

<span style=color:#75715e># 说明:只有当设置 innodb_buffer_pool_size 值大于1G时才有意义，小于1G，instances默认为1，大于1G，instances默认为8</span>
<span style=color:#75715e># 但是网络上有评价，最佳性能，每个实例至少1G大小。</span>
<span style=color:#75715e># 默认值：1或8，建议值：innodb_buffer_pool_size/innodb_buffer_pool_instances &gt;= 1G</span>
innodb_buffer_pool_instances <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e># 说明：mysql 5.7 新特性，defines the chunk size for online InnoDB buffer pool resizing operations.</span>
<span style=color:#75715e># 实际缓冲区大小必须为innodb_buffer_pool_chunk_size*innodb_buffer_pool_instances*倍数，取略大于innodb_buffer_pool_size</span>
<span style=color:#75715e># 默认值128M，建议值：默认值就好，乱改反而容易出问题，它会影响实际buffer pool大小。</span>
innodb_buffer_pool_chunk_size <span style=color:#f92672>=</span> 128M 

<span style=color:#75715e># 在启动时把热数据加载到内存。默认值为on，不修改</span>
innodb_buffer_pool_load_at_startup <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
<span style=color:#75715e># 在关闭时把热数据dump到本地磁盘。默认值为on，不修改</span>
innodb_buffer_pool_dump_at_shutdown <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e># 说明：影响Innodb缓冲区的刷新算法，建议从小到大配置，直到zero free pages；innodb_lru_scan_depth * innodb_buffer_pool_instances defines the amount of work performed by the page cleaner thread each second.</span>
<span style=color:#75715e># 默认值1024，建议值: 未知</span>
innodb_lru_scan_depth <span style=color:#f92672>=</span> <span style=color:#ae81ff>1024</span>

<span style=color:#75715e># 说明：事务等待获取资源等待的最长时间，单位为秒，看具体业务情况，一般默认值就好</span>
<span style=color:#75715e># 默认值：50，建议值：看业务。</span>
innodb_lock_wait_timeout <span style=color:#f92672>=</span> <span style=color:#ae81ff>60</span>

<span style=color:#75715e># 说明：设置了Mysql后台任务（例如页刷新和merge dadta from buffer pool）每秒io操作的上限。</span>
<span style=color:#75715e># 默认值：200，建议值：方法一，单盘sata设100，sas10，raid10设200，ssd设2000，fushion-io设50000；方法二，通过测试工具获得磁盘io性能后，设置IOPS数值/2。</span>
innodb_io_capacity <span style=color:#f92672>=</span> <span style=color:#ae81ff>2000</span>
<span style=color:#75715e># 说明：该参数是所有缓冲区线程io操作的总上限。</span>
<span style=color:#75715e># 默认值：innodb_io_capacity的两倍。建议值：例如用iometer测试后的iops数值就好</span>
innodb_io_capacity_max <span style=color:#f92672>=</span> <span style=color:#ae81ff>4000</span>

<span style=color:#75715e># 说明：控制着innodb数据文件及redo log的打开、刷写模式，三种模式：fdatasync(默认)，O_DSYNC，O_DIRECT</span>
<span style=color:#75715e># fdatasync：数据文件，buffer pool-&gt;os buffer-&gt;磁盘；日志文件，buffer pool-&gt;os buffer-&gt;磁盘；</span>
<span style=color:#75715e># O_DSYNC：  数据文件，buffer pool-&gt;os buffer-&gt;磁盘；日志文件，buffer pool-&gt;磁盘；</span>
<span style=color:#75715e># O_DIRECT： 数据文件，buffer pool-&gt;磁盘；           日志文件，buffer pool-&gt;os buffer-&gt;磁盘；</span>
<span style=color:#75715e># 默认值为空，建议值：使用SAN或者raid，建议用O_DIRECT，不懂测试的话，默认生产上使用O_DIRECT</span>
innodb_flush_method <span style=color:#f92672>=</span> O_DIRECT


<span style=color:#75715e># 说明：mysql5.7之后默认开启，意思是，每张表一个独立表空间。</span>
<span style=color:#75715e># 默认值1，开启</span>
innodb_file_per_table <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e># 说明：The path where InnoDB creates undo tablespaces.通常等于undo log文件的存放目录。</span>
<span style=color:#75715e># 默认值./;自行设置</span>
innodb_undo_directory <span style=color:#f92672>=</span> /usr/local/mysql8/log
<span style=color:#75715e># 说明：5.7.5后开始使用，在线收缩undo log使用的空间。</span>
<span style=color:#75715e># 默认值：关闭，建议值：开启</span>
innodb_undo_log_truncate <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
<span style=color:#75715e># 说明：结合innodb_undo_log_truncate，实现undo空间收缩功能</span>
<span style=color:#75715e># 默认值：1G，建议值，不改。</span>
innodb_max_undo_log_size <span style=color:#f92672>=</span> 1G

<span style=color:#75715e># 说明：重作日志文件的存放目录</span>
innodb_log_group_home_dir <span style=color:#f92672>=</span> /usr/local/mysql8/log
<span style=color:#75715e># 说明：日志文件的大小</span>
<span style=color:#75715e># 默认值:48M,建议值：根据你系统的磁盘空间和日志增长情况调整大小</span>
innodb_log_file_size <span style=color:#f92672>=</span> 128M
<span style=color:#75715e># 说明：日志组中的文件数量，mysql以循环方式写入日志</span>
<span style=color:#75715e># 默认值2，建议值：根据你系统的磁盘空间和日志增长情况调整大小</span>
innodb_log_files_in_group <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
<span style=color:#75715e># 此参数确定些日志文件所用的内存大小，以M为单位。缓冲区更大能提高性能，但意外的故障将会丢失数据。MySQL开发人员建议设置为1－8M之间</span>
innodb_log_buffer_size <span style=color:#f92672>=</span> 16M



<span style=color:#75715e># 说明：可以控制log从系统buffer刷入磁盘文件的刷新频率，增大可减轻系统负荷</span>
<span style=color:#75715e># 默认值是1；建议值不改。系统性能一般够用。</span>
innodb_flush_log_at_timeout <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
<span style=color:#75715e># 说明：参数可设为0，1，2；</span>
<span style=color:#75715e># 参数0：表示每秒将log buffer内容刷新到系统buffer中，再调用系统flush操作写入磁盘文件。</span>
<span style=color:#75715e># 参数1：表示每次事物提交，将log buffer内容刷新到系统buffer中，再调用系统flush操作写入磁盘文件。</span>
<span style=color:#75715e># 参数2：表示每次事物提交，将log buffer内容刷新到系统buffer中，隔1秒后再调用系统flush操作写入磁盘文件。</span>
innodb_flush_log_at_trx_commit <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>


<span style=color:#75715e># 说明：限制Innodb能打开的表的数据，如果库里的表特别多的情况，请增加这个。</span>
<span style=color:#75715e># 值默认是2000，建议值：参考数据库表总数再进行调整，一般够用不用调整。</span>
innodb_open_files <span style=color:#f92672>=</span> <span style=color:#ae81ff>8192</span>

<span style=color:#75715e># innodb处理io读写的后台并发线程数量，根据cpu核来确认，取值范围：1-64</span>
<span style=color:#75715e># 默认值：4，建议值：与逻辑cpu数量的一半保持一致。</span>
innodb_read_io_threads <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>
innodb_write_io_threads <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>
<span style=color:#75715e># 默认设置为 0,表示不限制并发数，这里推荐设置为0，更好去发挥CPU多核处理能力，提高并发量</span>
innodb_thread_concurrency <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
<span style=color:#75715e># 默认值为4，建议不变。InnoDB中的清除操作是一类定期回收无用数据的操作。mysql 5.5之后，支持多线程清除操作。</span>
innodb_purge_threads <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span> 

<span style=color:#75715e># 说明：mysql缓冲区分为new blocks和old blocks；此参数表示old blocks占比；</span>
<span style=color:#75715e># 默认值：37，建议值，一般不动</span>
innodb_old_blocks_pct <span style=color:#f92672>=</span> <span style=color:#ae81ff>37</span>
<span style=color:#75715e># 说明：新数据被载入缓冲池，进入old pages链区，当1秒后再次访问，则提升进入new pages链区。</span>
<span style=color:#75715e># 默认值：1000</span>
innodb_old_blocks_time<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>
<span style=color:#75715e># 说明：开启异步io，可以提高并发性，默认开启。</span>
<span style=color:#75715e># 默认值为1，建议不动</span>
innodb_use_native_aio <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>

<span style=color:#75715e># 说明：默认为空，使用data目录，一般不改。</span>
innodb_data_home_dir<span style=color:#f92672>=</span>/usr/local/mysql8/data
<span style=color:#75715e># 说明：Defines the name, size, and attributes of InnoDB system tablespace data files.</span>
<span style=color:#75715e># 默认值，不指定，默认为ibdata1:12M:autoextend</span>
innodb_data_file_path <span style=color:#f92672>=</span> ibdata1:12M:autoextend


<span style=color:#75715e># 说明：The crash recovery mode。只有紧急情况需要恢复数据的时候，才改为大于1-6之间数值，含义查下官网。</span>
<span style=color:#75715e># 默认值为0；</span>
<span style=color:#75715e>#innodb_force_recovery = 0</span>

<span style=color:#75715e>##########################################################################################################</span>
<span style=color:#75715e># 其他。。。。</span>
<span style=color:#75715e># 参考http://www.kuqin.com/database/20120815/328905.html</span>
<span style=color:#75715e># skip-external-locking</span>

<span style=color:#75715e># 禁止MySQL对外部连接进行DNS解析，使用这一选项可以消除MySQL进行DNS解析的时间。</span>
<span style=color:#75715e># 缺点：所有远程主机连接授权都要使用IP地址方式，因为只认得ip地址了。</span>
<span style=color:#75715e># skip_name_resolve = 0</span>

<span style=color:#75715e># 默认值为off,timestamp列会自动更新为当前时间，设置为on|1，timestamp列的值就要显式更新</span>
explicit_defaults_for_timestamp <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>




<span style=color:#f92672>[</span>mysqldump<span style=color:#f92672>]</span>
<span style=color:#75715e># quick选项强制 mysqldump 从服务器查询取得记录直接输出而不是取得所有记录后将它们缓存到内存中</span>
quick
max_allowed_packet <span style=color:#f92672>=</span> 16M

<span style=color:#f92672>[</span>mysql<span style=color:#f92672>]</span>
<span style=color:#75715e># mysql命令行工具不使用自动补全功能，建议还是改为</span>
<span style=color:#75715e># no-auto-rehash</span>
auto-rehash
socket <span style=color:#f92672>=</span> /tmp/mysql.sock

</code></pre></div><p>创建my.cnf后</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#75715e># 切换到安装目录</span>
cd /usr/local/mysql8

<span style=color:#75715e># 创建相关文件</span>
mkdir data log
chown -R mysql:mysql data log

<span style=color:#75715e># 初始化mysql, --defaults-file的参数就是刚才创建的配置文件, --basedir的参数就是mysql安装目录, --datadir的参数就是mysql数据目录</span>
./bin/mysqld --defaults-file<span style=color:#f92672>=</span>/etc/my.cnf --initialize --user<span style=color:#f92672>=</span>mysql --basedir<span style=color:#f92672>=</span>/usr/local/mysql8/ --datadir<span style=color:#f92672>=</span>/usr/local/mysql8/data/

<span style=color:#75715e># 会返回类似代码</span>
  <span style=color:#f92672>[</span>System<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>MY-013169<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Server<span style=color:#f92672>]</span> /usr/local/mysql8/bin/mysqld <span style=color:#f92672>(</span>mysqld 8.0.20<span style=color:#f92672>)</span> initializing of server in progress as process <span style=color:#ae81ff>48055</span>
  <span style=color:#f92672>[</span>System<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>MY-013576<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>InnoDB<span style=color:#f92672>]</span> InnoDB initialization has started.
  <span style=color:#f92672>[</span>System<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>MY-013577<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>InnoDB<span style=color:#f92672>]</span> InnoDB initialization has ended.
  <span style=color:#f92672>[</span>Note<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>MY-010454<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>Server<span style=color:#f92672>]</span> A temporary password is generated <span style=color:#66d9ef>for</span> root@localhost: <span style=color:#f92672>=</span>tsSl-.Wt3ud
<span style=color:#75715e># &#34;root@localhost:&#34; 后边跟着就是mysql为root生成的临时密码,记下来,开启mysql后,可以用这个密码登录(如果没返回上述代码,则查看日志,如: vim log/mysql-error.log)</span>

</code></pre></div><p>开启并修改root密码</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>
cd /usr/local/mysql8

<span style=color:#75715e># 开启mysql</span>
./support-files/mysql.server start

<span style=color:#75715e># 登录并输入刚才记下的临时密码</span>
./bin/mysql -uroot -p

<span style=color:#75715e># 修改root密码</span>
mysql&gt; alter user <span style=color:#e6db74>&#39;root&#39;</span>@<span style=color:#e6db74>&#39;localhost&#39;</span> identified by <span style=color:#e6db74>&#34;123456&#34;</span>;

</code></pre></div><hr><h2 id=笔记三-开关mysql>笔记三: 开关mysql</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cd /usr/local/mysql8

<span style=color:#75715e># 开启mysql进程</span>
./bin/mysqld -u mysql
<span style=color:#75715e># 关闭mysql进程</span>
./bin/mysqladmin -uroot shutdown

<span style=color:#75715e># 开启mysqld的守护进程,实际上是开启mysqld,当mysqld意外关闭时,mysqld_safe自动重启mysqld(可添加--skip-grant-tables参数,root可免密登录)</span>
./bin/mysqld_safe --user<span style=color:#f92672>=</span>mysql &amp;
<span style=color:#75715e># 关闭mysqld的守护进程</span>
./bin/mysqladmin -uroot shutdown

<span style=color:#75715e># 开启mysql服务,实际是开启mysqld_safe</span>
./support-files/mysql.server start
<span style=color:#75715e># 关闭mysql服务</span>
./support-files/mysql.server stop

<span style=color:#75715e># 登录mysql</span>
./bin/mysql -uroot -p

<span style=color:#75715e># 软连接(软连接的源文件路径要写成绝对路径)</span>
ln -s /usr/local/mysql8/bin/* /usr/local/bin/
<span style=color:#75715e># 启动设置</span>
cp support-files/mysql.server /etc/init.d/mysql.server

</code></pre></div></div><div class=article-tags><a class="badge badge-light" href=/tags/mysql/>Mysql</a></div><section id=comments><div id=container></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script><script>var gitalk=new Gitalk({clientID:"a8bef379318b69f91ee5",clientSecret:"efdbcdaea767631fb232dd600e8f593d7652403c",repo:"twbworld.GitHub.io",owner:"twbworld",admin:["twbworld"],id:window.location.pathname.match(/\w+/g).pop().slice(-50)});gitalk.render('container')</script></section></div></main></div></div></article></div><div class=page-footer><div class="home-section bg-image parallax" style=background-color:initial><footer class=site-footer><ul class="network-icon powered-by" style=text-align:center;display:block aria-hidden=true><li style=display:inline-block><a href=https://github.com/twbworld title=github target=_blank rel=noopener><i class="fab fa-github big-icon"></i></a></li><li style=display:inline-block><a href=https://twitter.com/twbworld title=twitter target=_blank rel=noopener><i class="fab fa-twitter big-icon"></i></a></li><li style=display:inline-block><a href=https://www.instagram.com/twbworld title=instagram target=_blank rel=noopener><i class="fab fa-instagram big-icon"></i></a></li><li style=display:inline-block><a href=http://weibo.com/u/2646212535 title=weibo target=_blank rel=noopener><i class="fab fa-weibo big-icon"></i></a></li><li style=display:inline-block><a href=https://www.zhihu.com/people/tan-te-41 title=zhihu target=_blank rel=noopener><i class="fab fa-zhihu big-icon"></i></a></li></ul><p class=powered-by><a href=/authors/admin/><img src=https://img.shields.io/badge/%C2%A9-2020%20%2D-%202021_%E5%BF%90%E5%BF%91-yellow alt=忐忑的博客></a> <a href=javascript:void(0) id=shields-views></a><br><a href=https://github.com/twbworld/twbworld.GitHub.io><img src="https://img.shields.io/github/tag/twbworld/twbworld.GitHub.io?logo=github" alt=忐忑的博客></a> <a href=https://gohugo.io/><img src="https://img.shields.io/badge/powered-hugo-ff4088?logo=hugo" alt=Hugo></a> <a href=https://wowchemy.com/><img src=https://img.shields.io/badge/theme-wowchemy-00d1b2 alt=wowchemy></a></p><p class=powered-by><span class=float-right aria-hidden=true><a href=# class=back-to-top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p></footer></div></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>引用</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> 复制</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> 下载</a><div id=modal-error></div></div></div></div></div><script src=https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://cdn.staticfile.org/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script><script src=https://cdn.staticfile.org/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script><script src=https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script><script src=https://cdn.staticfile.org/instant.page/5.1.0/instantpage.min.js integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin=anonymous></script><script src=https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js integrity></script><script type=text/javascript>window.onload=function(){const b=document.getElementById("busuanzi_value_site_pv").innerHTML,a=document.createElement('img');a.alt='Hi !',a.title='Hi !',a.src='https://img.shields.io/badge/views-'+b+'-purple',document.getElementById('shields-views').appendChild(a)}</script><span id=busuanzi_container_site_pv><span id=busuanzi_value_site_pv style=display:none!important>*</span></span>
<script src=https://cdn.staticfile.org/mermaid/8.8.4/mermaid.min.js integrity="sha512-as1BF4+iHZ3BVO6LLDQ7zrbvTXM+c/1iZ1qII/c3c4L8Rn5tHLpFUtpaEtBNS92f+xGsCzsD7b62XP3XYap6oA==" crossorigin=anonymous title=mermaid></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/php.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/php-template.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/go.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/python.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/css.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/javascript.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/shell.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/bash.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/json.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/yaml.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/xml.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/nginx.min.js></script><script src=https://cdn.staticfile.org/highlight.js/10.2.0/languages/sql.min.js></script><script src=https://cdn.staticfile.org/leaflet/1.7.1/leaflet.min.js integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin=anonymous></script><script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script><script src=https://cdn.staticfile.org/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script><script src=https://cdn.staticfile.org/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/twbworld/twbworld.GitHub.io@gh-pages/js/_vendor/bootstrap.bundle.min.f8467c1d3e2740d8f3195894a328004e.js></script><script src=https://cdn.jsdelivr.net/gh/twbworld/twbworld.GitHub.io@gh-pages/zh/js/wowchemy.min.de940c023919d45018fdcd2e39012788.js></script></body></html>